---
title: SPEC-SCR-C04 工数入力
description: 日次の工数入力画面仕様
---

## 目的 / In-Out / Related
- **目的**: メンバーが日単位で作業時間をタスクに紐付けて記録する
- **対象範囲（In/Out）**: 日次入力・週次ビュー・保存。集計は SCR-C05
- **Related**: REQ-C03 / SPEC-API-C04 / DD-DB-timesheets

## 画面情報
- **画面ID**: SPEC-SCR-C04
- **画面名**: 工数入力
- **対象ロール**: Member, PM
- **URL**: `/timesheet`
- **状態**: Draft

## UI構成（概要）
- **週カレンダー**: Mon〜Sun のグリッド表示
- **行**: プロジェクト × タスクの組み合わせ
- **セル**: 時間入力（0.25h単位、数値入力 or +/- ボタン）
- **合計行**: 日ごとの合計、週合計
- **「行追加」**: プロジェクト・タスク選択で行を追加
- **保存ボタン**: 変更がある場合のみアクティブ

## 入力項目
|項目|型|必須|バリデーション|備考|
|---|---|---:|---|---|
| プロジェクト | select | ✅ | アサイン済みPJから選択 | — |
| タスク | select | ✅ | PJ配下のタスクから選択 | — |
| 時間 | number | ✅ | 0〜24h、0.25h単位 | 日ごとのセル |

## 振る舞い・遷移
- 正常系: 入力 → 保存 → トースト「保存しました」、データは即座にPMの集計に反映
- 週切替: 前週/次週ボタンで移動（未保存変更時は確認ダイアログ）
- 異常系: 日合計が24h超過 → 警告表示（保存は可能）

## エラー/例外
- アサインされていないPJを選択: RLSで選択肢に出ない
- 保存失敗: 入力値を保持してリトライ可能

## 監査ログポイント
- `timesheet.create`: 新規入力時
- `timesheet.update`: 修正時（before/after記録）

## 関連リンク
- Related: REQ-C03 / SPEC-SCR-C05 / SPEC-API-C04
