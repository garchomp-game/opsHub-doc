---
title: SPEC-SCR-H01 請求一覧
description: 請求書の一覧表示・フィルタリング画面の仕様
---

## 目的 / In-Out / Related
- **目的**: テナント内の請求書を一覧表示し、ステータス・プロジェクト・期間でフィルタリングする
- **対象範囲（In/Out）**: 一覧表示、ステータスフィルタ、プロジェクトフィルタ、期間フィルタ。PDF生成・明細編集は SCR-H02 の範囲
- **Related**: REQ-E01 / SPEC-API-H01 / SPEC-SCR-H02 / DD-DB-013(invoices)

---

## 画面情報
- **画面ID**: SPEC-SCR-H01
- **画面名**: 請求一覧
- **対象ロール**: Accounting, PM（閲覧のみ）, Tenant Admin
- **URL**: `/invoices`
- **状態**: Draft

---

## ロール別表示ルール

| ロール | 表示範囲 | 操作権限 |
|---|---|---|
| Accounting | テナント内の全請求書 | 作成・編集・削除 |
| Tenant Admin | テナント内の全請求書 | 作成・編集・削除 |
| PM | **自プロジェクトの請求書のみ** (`project_id` がアサイン済PJ) | 閲覧のみ |

---

## 主要ユースケース
- 経理担当が請求書の発行状況を確認する
- PMが自プロジェクトの請求状況を把握する
- ステータスフィルタで未入金の請求書を絞り込む
- 期間指定で月次の請求一覧を確認する

---

## UI構成（概要）

```
┌──────────────────────────────────────────────────────────────┐
│  [h2] 請求一覧                              [+ 新規作成] ボタン │
├──────────────────────────────────────────────────────────────┤
│  フィルタ Card                                                │
│  ┌──────────────────────────────────────────────────────┐    │
│  │ [ステータス ▼] [プロジェクト ▼] [開始日] 〜 [終了日]    │    │
│  │                                         [フィルタ]   │    │
│  └──────────────────────────────────────────────────────┘    │
├──────────────────────────────────────────────────────────────┤
│  一覧テーブル Card                                            │
│  ┌────────┬──────┬────────┬──────┬──────┬───────┬──────┬────┬───┐
│  │請求番号│取引先│ﾌﾟﾛｼﾞｪｸﾄ│発行日│支払期日│金額(税込)│ｽﾃｰﾀｽ│作成者│操作│
│  ├────────┼──────┼────────┼──────┼──────┼───────┼──────┼────┼───┤
│  │INV-2026│A社   │PJ-X    │02/01│02/28 │¥110,000│送付済│山田│…  │
│  │INV-2026│B社   │PJ-Y    │02/01│03/15 │¥55,000 │下書き│鈴木│…  │
│  └────────┴──────┴────────┴──────┴──────┴───────┴──────┴────┴───┘
│  全 XX 件                                        20件/ページ  │
└──────────────────────────────────────────────────────────────┘
```

---

## テーブル列定義

| # | 列名 | データソース | 表示形式 | 備考 |
|---|---|---|---|---|
| 1 | 請求番号 | `invoices.invoice_number` | リンク（`/invoices/{id}`） | `INV-YYYY-NNNN` 形式。詳細画面へ遷移 |
| 2 | 取引先名 | `invoices.client_name` | テキスト | — |
| 3 | プロジェクト | `projects.name` | リンク（`/projects/{id}`） | プロジェクト詳細へ遷移。未紐付時は「—」 |
| 4 | 発行日 | `invoices.issued_date` | `ja-JP` ロケール日付 | — |
| 5 | 支払期日 | `invoices.due_date` | `ja-JP` ロケール日付 | 期限超過時は赤字表示 |
| 6 | 金額（税込） | `invoices.total_amount` | `¥` + カンマ区切り | — |
| 7 | ステータス | `invoices.status` | Tag（色分け） | 下記ステータス色参照 |
| 8 | 作成者 | `profiles.display_name` | テキスト | `created_by` JOIN |
| 9 | 操作 | — | ボタン群 | 詳細 / PDF出力 |

---

## ステータス色定義

| ステータス | 表示ラベル | Tag色 |
|---|---|---|
| `draft` | 下書き | `blue` |
| `sent` | 送付済 | `orange` |
| `paid` | 入金済 | `green` |
| `cancelled` | キャンセル | `default` |

---

## フィルタ

| フィルタ項目 | 型 | 選択肢 | 備考 |
|---|---|---|---|
| ステータス | Select | すべて / 下書き / 送付済 / 入金済 / キャンセル | GET パラメータ `?status=` |
| プロジェクト | Select | テナント内プロジェクト一覧 | GET パラメータ `?project_id=` |
| 期間（発行日） | DatePicker × 2 | 開始日〜終了日 | `?from=` / `?to=` |

---

## ページネーション
- 1ページあたり **20件**
- 合計件数を `全 XX 件` で表示
- ソート: `issued_date` 降順（デフォルト）

---

## 振る舞い・遷移
- 「新規作成」ボタン → `/invoices/new` へ遷移（PM ロールには非表示）
- 請求番号リンク → `/invoices/{id}` へ遷移（詳細/編集画面）
- プロジェクトリンク → `/projects/{id}` へ遷移
- 操作列「PDF」ボタン → PDF出力（印刷ダイアログ or ダウンロード）
- フィルタ適用 → GET パラメータ付きでページリロード
- 権限エラー時 → ダッシュボードへリダイレクト

---

## エラー/例外
- サーバーエラー: `message.error()` でトースト通知
- ネットワークエラー: フィルタ状態を保持したままリトライ可能
- 権限不足: ダッシュボードへリダイレクト

## 監査ログポイント
- 請求一覧の閲覧自体は監査ログ不要
- PDF出力時: `invoice.export_pdf`

## 関連リンク
- Related: REQ-E01 / SPEC-API-H01 / SPEC-SCR-H02 / DD-DB-013(invoices)
